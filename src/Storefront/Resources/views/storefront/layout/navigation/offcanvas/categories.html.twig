{# @var navigation \Shopware\Core\Content\Category\Tree\Tree #}
{% set activeId = navigation.active.id ?? context.salesChannel.navigationCategoryId %}
{% set isRoot = activeId == context.salesChannel.navigationCategoryId %}
{% set children = navigation.children(activeId) %}
{% set active = navigation.active %}

{% block layout_navigation_offcanvas_navigation_categories %}
    <div class="navigation-offcanvas-container js-navigation-offcanvas">
        <div class="navigation-offcanvas-overlay-content js-navigation-offcanvas-overlay-content">
            {% if not isRoot %}
                {% sw_include '@Storefront/storefront/layout/navigation/offcanvas/show-all-link.html.twig' %}

                {# @deprecated tag:v6.5.0 - Passed variable `item` will be removed. Variable `treeItem` will be passed instead. #}
                {% sw_include '@Storefront/storefront/layout/navigation/offcanvas/active-item-link.html.twig' with { item: active, treeItem: active } %}

                {# @deprecated tag:v6.5.0 - Passed variable `item` will be removed. Variable `treeItem` will be passed instead. #}
                {% sw_include '@Storefront/storefront/layout/navigation/offcanvas/back-link.html.twig' with { item: active, treeItem: active } %}
            {% else %}
                {% sw_include '@Storefront/storefront/layout/navigation/offcanvas/general-headline.html.twig' %}
            {% endif %}

            <ul class="list-unstyled navigation-offcanvas-list">
                {% if isRoot %}
                    {% block layout_main_navigation_menu_home %}
                        {% set homeLabel = context.salesChannel.translated.homeName|default("general.homeLink"|trans) %}
                        {% set isActive = page.navigationId == activeId %}
                    
                        {% if context.salesChannel.translated.homeEnabled %}
                            <li class="navigation-offcanvas-list-item">
                                <a class="navigation-offcanvas-link nav-item nav-link {% if isActive %} navigation-offcanvas-headline {% endif %}"
                                    href="{{ path('frontend.home.page') }}"
                                    itemprop="url"
                                    title="{{ homeLabel|striptags }}">
                                    <div class="main-navigation-link-text">
                                        <span itemprop="name">{{ homeLabel|sw_sanitize }}</span>
                                    </div>
                                </a>
                            </li>
                        {% endif %}
                    {% endblock %}
                {% endif %}
                
                {% if not isRoot and page.navigation.active.type != "folder" %}
                    {# @deprecated tag:v6.5.0 - Passed variable `item` will be removed. Variable `treeItem` will be passed instead. #}
                    {% sw_include '@Storefront/storefront/layout/navigation/offcanvas/show-active-link.html.twig' with { item: active, treeItem: active } %}
                {% endif %}

                {# @var item \Shopware\Core\Content\Category\Tree\TreeItem #}
                {% for treeItem in children.tree %}
                    {# @deprecated tag:v6.5.0 - Passed variable `item` will be removed. Variable `treeItem` will be passed instead. #}
                    {% sw_include '@Storefront/storefront/layout/navigation/offcanvas/item-link.html.twig' with { item: treeItem, treeItem: treeItem, activeId: activeId } %}
                {% endfor %}
            </ul>
        </div>
    </div>
{% endblock %}
