"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["custom_plugins_AsyncPlugin_src_Resources_app_storefront_src_plugins_off-canvas-extension_js"],{714:(e,t,s)=>{s.r(t),s.d(t,{default:()=>A});var n=s(285),r=s(206);class i{constructor(){this._request=null}get(e,t,s="application/json"){const n=this._createPreparedRequest("GET",e,s);return this._sendRequest(n,null,t)}post(e,t,s,n="application/json"){n=this._getContentType(t,n);const r=this._createPreparedRequest("POST",e,n);return this._sendRequest(r,t,s)}delete(e,t,s,n="application/json"){n=this._getContentType(t,n);const r=this._createPreparedRequest("DELETE",e,n);return this._sendRequest(r,t,s)}patch(e,t,s,n="application/json"){n=this._getContentType(t,n);const r=this._createPreparedRequest("PATCH",e,n);return this._sendRequest(r,t,s)}abort(){if(this._request)return this._request.abort()}_registerOnLoaded(e,t){t&&e.addEventListener("loadend",(()=>{t(e.responseText,e)}))}_sendRequest(e,t,s){return this._registerOnLoaded(e,s),e.send(t),e}_getContentType(e,t){return e instanceof FormData&&(t=!1),t}_createPreparedRequest(e,t,s){return this._request=new XMLHttpRequest,this._request.open(e,t),this._request.setRequestHeader("X-Requested-With","XMLHttpRequest"),s&&this._request.setRequestHeader("Content-type",s),this._request}}class o{static isTouchDevice(){return"ontouchstart"in document.documentElement}static isIOSDevice(){return o.isIPhoneDevice()||o.isIPadDevice()}static isNativeWindowsBrowser(){return o.isIEBrowser()||o.isEdgeBrowser()}static isIPhoneDevice(){return!!navigator.userAgent.match(/iPhone/i)}static isIPadDevice(){return!!navigator.userAgent.match(/iPad/i)}static isIEBrowser(){return-1!==navigator.userAgent.toLowerCase().indexOf("msie")||!!navigator.userAgent.match(/Trident.*rv:\d+\./)}static isEdgeBrowser(){return!!navigator.userAgent.match(/Edge\/\d+/i)}static getList(){return{"is-touch":o.isTouchDevice(),"is-ios":o.isIOSDevice(),"is-native-windows":o.isNativeWindowsBrowser(),"is-iphone":o.isIPhoneDevice(),"is-ipad":o.isIPadDevice(),"is-ie":o.isIEBrowser(),"is-edge":o.isEdgeBrowser()}}}var a=s(5);class c{static iterate(e,t){if(e instanceof Map)return e.forEach(t);if(Array.isArray(e))return e.forEach(t);if(!(e instanceof FormData)){if(e instanceof NodeList)return e.forEach(t);if(e instanceof HTMLCollection)return Array.from(e).forEach(t);if(e instanceof Object)return Object.keys(e).forEach((s=>{t(e[s],s)}));throw new Error(`The element type ${typeof e} is not iterable!`)}for(var s of e.entries())t(s[1],s[0])}}const u="offcanvas",l=350;class h{constructor(){this.$emitter=new a.Z}open(e,t,s,n,r,i,o){this._removeExistingOffCanvas();const a=this._createOffCanvas(s,i,o,n);this.setContent(e,n,r),this._openOffcanvas(a,t)}setContent(e,t,s){const n=this.getOffCanvas();n[0]&&(n[0].innerHTML=e,this._registerEvents(s))}setAdditionalClassName(e){this.getOffCanvas()[0].classList.add(e)}getOffCanvas(){return document.querySelectorAll(`.${u}`)}close(e){const t=this.getOffCanvas();c.iterate(t,(e=>{bootstrap.Offcanvas.getInstance(e).hide()})),setTimeout((()=>{this.$emitter.publish("onCloseOffcanvas",{offCanvasContent:t})}),e)}goBackInHistory(){window.history.back()}exists(){return this.getOffCanvas().length>0}_openOffcanvas(e,t){h.bsOffcanvas.show(),window.history.pushState("offcanvas-open",""),"function"==typeof t&&t()}_registerEvents(e){const t=o.isTouchDevice()?"touchend":"click",s=this.getOffCanvas();c.iterate(s,(t=>{const n=()=>{setTimeout((()=>{t.remove(),this.$emitter.publish("onCloseOffcanvas",{offCanvasContent:s})}),e),t.removeEventListener("hide.bs.offcanvas",n)};t.addEventListener("hide.bs.offcanvas",n)})),window.addEventListener("popstate",this.close.bind(this,e),{once:!0});const n=document.querySelectorAll(".js-offcanvas-close");c.iterate(n,(s=>s.addEventListener(t,this.close.bind(this,e))))}_removeExistingOffCanvas(){h.bsOffcanvas=null;const e=this.getOffCanvas();return c.iterate(e,(e=>e.remove()))}_getPositionClass(e){return"left"===e?"offcanvas-start":"right"===e?"offcanvas-end":`offcanvas-${e}`}_createOffCanvas(e,t,s,n){const r=document.createElement("div");if(r.classList.add(u),r.classList.add(this._getPositionClass(e)),!0===t&&r.classList.add("is-fullwidth"),s){const e=typeof s;if("string"===e)r.classList.add(s);else{if(!Array.isArray(s))throw new Error(`The type "${e}" is not supported. Please pass an array or a string.`);s.forEach((e=>{r.classList.add(e)}))}}return document.body.appendChild(r),h.bsOffcanvas=new bootstrap.Offcanvas(r,{backdrop:!1!==n||"static"}),r}}const d=Object.freeze(new h);class f{static open(e,t=null,s="left",n=!0,r=350,i=!1,o=""){d.open(e,t,s,n,r,i,o)}static setContent(e,t=!0,s=350){d.setContent(e,t,s)}static setAdditionalClassName(e){d.setAdditionalClassName(e)}static close(e=350){d.close(e)}static exists(){return d.exists()}static getOffCanvas(){return d.getOffCanvas()}static REMOVE_OFF_CANVAS_DELAY(){return l}}const p="loader",g="before",v="inner";class m{constructor(e,t=g){this.parent=e instanceof Element?e:document.body.querySelector(e),this.position=t}create(){this.exists()||(this.position!==v?this.parent.insertAdjacentHTML(this._getPosition(),m.getTemplate()):this.parent.innerHTML=m.getTemplate())}remove(){const e=this.parent.querySelectorAll(`.${p}`);c.iterate(e,(e=>e.remove()))}exists(){return this.parent.querySelectorAll(`.${p}`).length>0}_getPosition(){return this.position===g?"afterbegin":"beforeend"}static getTemplate(){return`<div class="${p}" role="status">\n                    <span class="visually-hidden">Loading...</span>\n                </div>`}static SELECTOR_CLASS(){return p}}let b=null;class _ extends f{static open(e=!1,t=!1,s=null,n="left",r=!0,i=f.REMOVE_OFF_CANVAS_DELAY(),o=!1,a=""){if(!e)throw new Error("A url must be given!");d._removeExistingOffCanvas();const c=d._createOffCanvas(n,o,a,r);this.setContent(e,t,s,r,i),d._openOffcanvas(c)}static setContent(e,t,s,n,r){const o=new i;super.setContent(`<div class="offcanvas-body">${m.getTemplate()}</div>`,n,r),b&&b.abort();const a=e=>{super.setContent(e,n,r),"function"==typeof s&&s(e)};b=t?o.post(e,t,_.executeCallback.bind(this,a)):o.get(e,_.executeCallback.bind(this,a))}static executeCallback(e,t){"function"==typeof e&&e(t),window.PluginManager.initializePlugins()}}class C{static serialize(e,t=!0){if("FORM"!==e.nodeName){if(t)throw new Error("The passed element is not a form!");return{}}return new FormData(e)}static serializeJson(e,t=!0){const s=C.serialize(e,t);if(s==={})return s;const n={};return c.iterate(s,((e,t)=>n[t]=e)),n}}const y="element-loader-backdrop";class w extends m{static create(e){e.classList.add("has-element-loader"),w.exists(e)||(w.appendLoader(e),setTimeout((()=>{const t=e.querySelector(`.${y}`);t&&t.classList.add("element-loader-backdrop-open")}),1))}static remove(e){e.classList.remove("has-element-loader");const t=e.querySelector(`.${y}`);t&&t.remove()}static exists(e){return e.querySelectorAll(`.${y}`).length>0}static getTemplate(){return`\n        <div class="${y}">\n            <div class="loader" role="status">\n                <span class="visually-hidden">Loading...</span>\n            </div>\n        </div>\n        `}static appendLoader(e){e.insertAdjacentHTML("beforeend",w.getTemplate())}}class E{static debounce(e,t,s=!1){let n;return(...r)=>{s&&!n&&setTimeout(e.bind(e,...r),0),clearTimeout(n),n=setTimeout(e.bind(e,...r),t)}}}class O extends n.Z{init(){this.client=new i,this._registerOpenTriggerEvents()}openOffCanvas(e,t,s){_.open(e,t,this._onOffCanvasOpened.bind(this,s),this.options.offcanvasPosition,!0),_.setAdditionalClassName(this.options.additionalOffcanvasClass)}_registerOpenTriggerEvents(){const e=o.isTouchDevice()?"touchstart":"click";this.el.addEventListener(e,this._onOpenOffCanvasCart.bind(this))}_onOpenOffCanvasCart(e){e.preventDefault(),this.openOffCanvas(window.router["frontend.cart.offcanvas"],!1)}_registerRemoveProductTriggerEvents(){const e=r.Z.querySelectorAll(document,this.options.removeProductTriggerSelector,!1);e&&c.iterate(e,(e=>e.addEventListener("submit",this._onRemoveProductFromCart.bind(this))))}_registerChangeQuantityProductTriggerEvents(){const e=r.Z.querySelectorAll(document,this.options.changeProductQuantityTriggerSelector,!1),t=r.Z.querySelectorAll(document,this.options.changeProductQuantityTriggerNumberSelector,!1);e&&c.iterate(e,(e=>e.addEventListener("change",this._onChangeProductQuantity.bind(this)))),t&&c.iterate(t,(e=>{e.addEventListener("change",E.debounce(this._onChangeProductQuantity.bind(this),this.options.changeQuantityInputDelay))}))}_registeraddPromotionTriggerEvents(){const e=r.Z.querySelectorAll(document,this.options.addPromotionTriggerSelector,!1);e&&c.iterate(e,(e=>e.addEventListener("submit",this._onAddPromotionToCart.bind(this))))}_registerUpdateShippingEvents(){const{shippingContainerSelector:e}=this.options,t=document.querySelector(`${e} select`);t&&t.addEventListener("input",this._onChangeShippingMethod.bind(this))}_registerToggleShippingSelection(){const{shippingToggleSelector:e,shippingContainerSelector:t}=this.options,s=document.querySelector(e);s&&s.addEventListener("click",(()=>{const e=document.querySelector(t),s="offcanvas-shipping-preference--hidden";e.classList.contains(s)?e.classList.remove(s):e.classList.add(s)}))}_registerEvents(){this._registerRemoveProductTriggerEvents(),this._registerChangeQuantityProductTriggerEvents(),this._registeraddPromotionTriggerEvents(),this._isShippingAvailable()&&(this._registerUpdateShippingEvents(),this._registerToggleShippingSelection()),this.$emitter.publish("registerEvents")}_onOffCanvasOpened(e,t){"function"==typeof e&&e(t),this.$emitter.publish("offCanvasOpened",{response:t}),this._fetchCartWidgets(),this._registerEvents()}_fireRequest(e,t,s){w.create(e.closest(t));const n=s?s.bind(this):this._onOffCanvasOpened.bind(this,this._updateOffCanvasContent.bind(this)),i=r.Z.getAttribute(e,"action"),o=C.serialize(e);this.$emitter.publish("beforeFireRequest"),this.client.post(i,o,n)}_onRemoveProductFromCart(e){e.preventDefault();const t=e.target,s=this.options.cartItemSelector;this.$emitter.publish("onRemoveProductFromCart"),this._fireRequest(t,s)}_onChangeProductQuantity(e){const t=e.target.closest("form"),s=this.options.cartItemSelector;this.$emitter.publish("onChangeProductQuantity"),this._fireRequest(t,s)}_onAddPromotionToCart(e){e.preventDefault();const t=e.target,s=this.options.cartPromotionSelector;this.$emitter.publish("onAddPromotionToCart"),this._fireRequest(t,s)}_fetchCartWidgets(){const e=window.PluginManager.getPluginInstances("CartWidget");c.iterate(e,(e=>e.fetch())),this.$emitter.publish("fetchCartWidgets")}_updateOffCanvasContent(e){f.setContent(e,!0,this._registerEvents.bind(this)),window.PluginManager.initializePlugins()}_isShippingAvailable(){const{shippingContainerSelector:e}=this.options;return!!document.querySelector(e)}_onChangeShippingMethod(e){e.preventDefault(),this.$emitter.publish("onShippingMethodChange");const t=window.router["frontend.cart.offcanvas"];this._fireRequest(e.target.form,".offcanvas-summary",(()=>{this.client.get(t,(e=>{this._updateOffCanvasContent(e),this._registerEvents()}),"text/html")}))}}var T,S,P;T=O,P={removeProductTriggerSelector:".js-offcanvas-cart-remove-product",changeProductQuantityTriggerSelector:".js-offcanvas-cart-change-quantity",changeProductQuantityTriggerNumberSelector:".js-offcanvas-cart-change-quantity-number",changeQuantityInputDelay:800,addPromotionTriggerSelector:".js-offcanvas-cart-add-promotion",cartItemSelector:".js-cart-item",cartPromotionSelector:".js-offcanvas-cart-promotion",offcanvasPosition:"right",shippingContainerSelector:".offcanvas-shipping-preference",shippingToggleSelector:".js-toggle-shipping-selection",additionalOffcanvasClass:"cart-offcanvas"},(S=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(S="options"))in T?Object.defineProperty(T,S,{value:P,enumerable:!0,configurable:!0,writable:!0}):T[S]=P;class A extends O{openOffCanvas(e,t,s){super.openOffCanvas(e,t,s),alert("method openOffCanvas overridden")}}},206:(e,t,s)=>{s.d(t,{Z:()=>r});var n=s(435);class r{static isNode(e){return"object"==typeof e&&null!==e&&(e===document||e===window||e instanceof Node)}static hasAttribute(e,t){if(!r.isNode(e))throw new Error("The element must be a valid HTML Node!");return"function"==typeof e.hasAttribute&&e.hasAttribute(t)}static getAttribute(e,t,s=!0){if(s&&!1===r.hasAttribute(e,t))throw new Error(`The required property "${t}" does not exist!`);if("function"==typeof e.getAttribute)return e.getAttribute(t);if(s)throw new Error("This node doesn't support the getAttribute function!")}static getDataAttribute(e,t,s=!0){const i=t.replace(/^data(|-)/,""),o=n.Z.toLowerCamelCase(i,"-");if(!r.isNode(e)){if(s)throw new Error("The passed node is not a valid HTML Node!");return}if(void 0===e.dataset){if(s)throw new Error("This node doesn't support the dataset attribute!");return}const a=e.dataset[o];if(void 0===a){if(s)throw new Error(`The required data attribute "${t}" does not exist on ${e}!`);return a}return n.Z.parsePrimitive(a)}static querySelector(e,t,s=!0){if(s&&!r.isNode(e))throw new Error("The parent node is not a valid HTML Node!");const n=e.querySelector(t)||!1;if(s&&!1===n)throw new Error(`The required element "${t}" does not exist in parent node!`);return n}static querySelectorAll(e,t,s=!0){if(s&&!r.isNode(e))throw new Error("The parent node is not a valid HTML Node!");let n=e.querySelectorAll(t);if(0===n.length&&(n=!1),s&&!1===n)throw new Error(`At least one item of "${t}" must exist in parent node!`);return n}}},5:(e,t,s)=>{s.d(t,{Z:()=>n});class n{constructor(e=document){this._el=e,e.$emitter=this,this._listeners=[]}publish(e,t={},s=!1){const n=new CustomEvent(e,{detail:t,cancelable:s});return this.el.dispatchEvent(n),n}subscribe(e,t,s={}){const n=this,r=e.split(".");let i=s.scope?t.bind(s.scope):t;if(s.once&&!0===s.once){const t=i;i=function(s){n.unsubscribe(e),t(s)}}return this.el.addEventListener(r[0],i),this.listeners.push({splitEventName:r,opts:s,cb:i}),!0}unsubscribe(e){const t=e.split(".");return this.listeners=this.listeners.reduce(((e,s)=>s.splitEventName.sort().toString()===t.sort().toString()?(this.el.removeEventListener(s.splitEventName[0],s.cb),e):(e.push(s),e)),[]),!0}reset(){return this.listeners.forEach((e=>{this.el.removeEventListener(e.splitEventName[0],e.cb)})),this.listeners=[],!0}get el(){return this._el}set el(e){this._el=e}get listeners(){return this._listeners}set listeners(e){this._listeners=e}}},435:(e,t,s)=>{s.d(t,{Z:()=>n});class n{static ucFirst(e){return e.charAt(0).toUpperCase()+e.slice(1)}static lcFirst(e){return e.charAt(0).toLowerCase()+e.slice(1)}static toDashCase(e){return e.replace(/([A-Z])/g,"-$1").replace(/^-/,"").toLowerCase()}static toLowerCamelCase(e,t){const s=n.toUpperCamelCase(e,t);return n.lcFirst(s)}static toUpperCamelCase(e,t){if(!t)return n.ucFirst(e.toLowerCase());return e.split(t).map((e=>n.ucFirst(e.toLowerCase()))).join("")}static parsePrimitive(e){try{return/^\d+(.|,)\d+$/.test(e)&&(e=e.replace(",",".")),JSON.parse(e)}catch(t){return e.toString()}}}},285:(e,t,s)=>{s.d(t,{Z:()=>c});var n=s(857),r=s.n(n),i=s(206),o=s(435),a=s(5);class c{constructor(e,t={},s=!1){if(!i.Z.isNode(e))throw new Error("There is no valid element given.");this.el=e,this.$emitter=new a.Z(this.el),this._pluginName=this._getPluginName(s),this.options=this._mergeOptions(t),this._initialized=!1,this._registerInstance(),this._init()}init(){throw new Error(`The "init" method for the plugin "${this._pluginName}" is not defined.`)}update(){}_init(){this._initialized||(this.init(),this._initialized=!0)}_update(){this._initialized&&this.update()}_mergeOptions(e){const t=o.Z.toDashCase(this._pluginName),s=i.Z.getDataAttribute(this.el,`data-${t}-config`,!1),n=i.Z.getAttribute(this.el,`data-${t}-options`,!1),a=[this.constructor.options,this.options,e];s&&a.push(window.PluginConfigManager.get(this._pluginName,s));try{n&&a.push(JSON.parse(n))}catch(e){throw console.error(this.el),new Error(`The data attribute "data-${t}-options" could not be parsed to json: ${e.message}`)}return r().all(a.filter((e=>e instanceof Object&&!(e instanceof Array))).map((e=>e||{})))}_registerInstance(){window.PluginManager.getPluginInstancesFromElement(this.el).set(this._pluginName,this);window.PluginManager.getPlugin(this._pluginName,!1).get("instances").push(this)}_getPluginName(e){return e||(e=this.constructor.name),e}}},857:e=>{var t=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===s}(e)}(e)};var s="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function n(e,t){return!1!==t.clone&&t.isMergeableObject(e)?c((s=e,Array.isArray(s)?[]:{}),e,t):e;var s}function r(e,t,s){return e.concat(t).map((function(e){return n(e,s)}))}function i(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return e.propertyIsEnumerable(t)})):[]}(e))}function o(e,t){try{return t in e}catch(e){return!1}}function a(e,t,s){var r={};return s.isMergeableObject(e)&&i(e).forEach((function(t){r[t]=n(e[t],s)})),i(t).forEach((function(i){(function(e,t){return o(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(o(e,i)&&s.isMergeableObject(t[i])?r[i]=function(e,t){if(!t.customMerge)return c;var s=t.customMerge(e);return"function"==typeof s?s:c}(i,s)(e[i],t[i],s):r[i]=n(t[i],s))})),r}function c(e,s,i){(i=i||{}).arrayMerge=i.arrayMerge||r,i.isMergeableObject=i.isMergeableObject||t,i.cloneUnlessOtherwiseSpecified=n;var o=Array.isArray(s);return o===Array.isArray(e)?o?i.arrayMerge(e,s,i):a(e,s,i):n(s,i)}c.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,s){return c(e,s,t)}),{})};var u=c;e.exports=u}}]);
